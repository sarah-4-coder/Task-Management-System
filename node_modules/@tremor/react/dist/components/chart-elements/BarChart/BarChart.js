'use client';
import{__rest as e}from"tslib";import{BaseColors as t}from"../../../lib/constants.js";import{themeColorRange as a,colorPalette as l}from"../../../lib/theme.js";import{tremorTwMerge as i}from"../../../lib/tremorTwMerge.js";import{getColorClassNames as o,defaultValueFormatter as r}from"../../../lib/utils.js";import n,{useState as s}from"react";import{ResponsiveContainer as c,BarChart as m,CartesianGrid as d,XAxis as v,YAxis as u,Tooltip as p,Legend as h,Bar as y}from"recharts";import g from"../common/ChartLegend.js";import f from"../common/ChartTooltip.js";import k from"../common/NoData.js";import{constructCategoryColors as b,deepEqual as x,getYAxisDomain as w}from"../common/utils.js";const E=n.forwardRef(((E,j)=>{const{data:L=[],categories:A=[],index:C,colors:T=a,valueFormatter:O=r,layout:N="horizontal",stack:D=!1,relative:G=!1,startEndOnly:S=!1,animationDuration:V=900,showAnimation:F=!1,showXAxis:K=!0,showYAxis:M=!0,yAxisWidth:z=56,intervalType:P="equidistantPreserveStart",showTooltip:X=!0,showLegend:B=!0,showGridLines:H=!0,autoMinValue:W=!1,minValue:Y,maxValue:q,allowDecimals:I=!0,noDataText:R,onValueChange:$,enableLegendSlider:J=!1,customTooltip:Q,rotateLabelX:U,barCategoryGap:Z,tickGap:_=5,className:ee}=E,te=e(E,["data","categories","index","colors","valueFormatter","layout","stack","relative","startEndOnly","animationDuration","showAnimation","showXAxis","showYAxis","yAxisWidth","intervalType","showTooltip","showLegend","showGridLines","autoMinValue","minValue","maxValue","allowDecimals","noDataText","onValueChange","enableLegendSlider","customTooltip","rotateLabelX","barCategoryGap","tickGap","className"]),ae=Q,le=K||M?20:0,[ie,oe]=s(60),re=b(A,T),[ne,se]=n.useState(void 0),[ce,me]=s(void 0),de=!!$;function ve(e,t,a){var l,i,o,r;a.stopPropagation(),$&&(x(ne,Object.assign(Object.assign({},e.payload),{value:e.value}))?(me(void 0),se(void 0),null==$||$(null)):(me(null===(i=null===(l=e.tooltipPayload)||void 0===l?void 0:l[0])||void 0===i?void 0:i.dataKey),se(Object.assign(Object.assign({},e.payload),{value:e.value})),null==$||$(Object.assign({eventType:"bar",categoryClicked:null===(r=null===(o=e.tooltipPayload)||void 0===o?void 0:o[0])||void 0===r?void 0:r.dataKey},e.payload))))}const ue=w(W,Y,q);return n.createElement("div",Object.assign({ref:j,className:i("w-full h-80",ee)},te),n.createElement(c,{className:"h-full w-full"},(null==L?void 0:L.length)?n.createElement(m,{barCategoryGap:Z,data:L,stackOffset:D?"sign":G?"expand":"none",layout:"vertical"===N?"vertical":"horizontal",onClick:de&&(ce||ne)?()=>{se(void 0),me(void 0),null==$||$(null)}:void 0},H?n.createElement(d,{className:i("stroke-1","stroke-tremor-border","dark:stroke-dark-tremor-border"),horizontal:"vertical"!==N,vertical:"vertical"===N}):null,"vertical"!==N?n.createElement(v,{padding:{left:le,right:le},hide:!K,dataKey:C,interval:S?"preserveStartEnd":P,tick:{transform:"translate(0, 6)"},ticks:S?[L[0][C],L[L.length-1][C]]:void 0,fill:"",stroke:"",className:i("mt-4 text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1,angle:null==U?void 0:U.angle,dy:null==U?void 0:U.verticalShift,height:null==U?void 0:U.xAxisHeight,minTickGap:_}):n.createElement(v,{hide:!K,type:"number",tick:{transform:"translate(-3, 0)"},domain:ue,fill:"",stroke:"",className:i("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1,tickFormatter:O,minTickGap:_,allowDecimals:I,angle:null==U?void 0:U.angle,dy:null==U?void 0:U.verticalShift,height:null==U?void 0:U.xAxisHeight}),"vertical"!==N?n.createElement(u,{width:z,hide:!M,axisLine:!1,tickLine:!1,type:"number",domain:ue,tick:{transform:"translate(-3, 0)"},fill:"",stroke:"",className:i("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickFormatter:G?e=>`${(100*e).toString()} %`:O,allowDecimals:I}):n.createElement(u,{width:z,hide:!M,dataKey:C,axisLine:!1,tickLine:!1,ticks:S?[L[0][C],L[L.length-1][C]]:void 0,type:"category",interval:"preserveStartEnd",tick:{transform:"translate(0, 6)"},fill:"",stroke:"",className:i("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content")}),n.createElement(p,{wrapperStyle:{outline:"none"},isAnimationActive:!1,cursor:{fill:"#d1d5db",opacity:"0.15"},content:X?({active:e,payload:a,label:l})=>ae?n.createElement(ae,{payload:null==a?void 0:a.map((e=>{var a;return Object.assign(Object.assign({},e),{color:null!==(a=re.get(e.dataKey))&&void 0!==a?a:t.Gray})})),active:e,label:l}):n.createElement(f,{active:e,payload:a,label:l,valueFormatter:O,categoryColors:re}):n.createElement(n.Fragment,null),position:{y:0}}),B?n.createElement(h,{verticalAlign:"top",height:ie,content:({payload:e})=>g({payload:e},re,oe,ce,de?e=>{return t=e,void(de&&(t!==ce||ne?(me(t),null==$||$({eventType:"category",categoryClicked:t})):(me(void 0),null==$||$(null)),se(void 0)));var t}:void 0,J)}):null,A.map((e=>{var a;return n.createElement(y,{className:i(o(null!==(a=re.get(e))&&void 0!==a?a:t.Gray,l.background).fillColor,$?"cursor-pointer":""),key:e,name:e,type:"linear",stackId:D||G?"a":void 0,dataKey:e,fill:"",isAnimationActive:F,animationDuration:V,shape:e=>((e,t,a,l)=>{const{fillOpacity:i,name:o,payload:r,value:s}=e;let{x:c,width:m,y:d,height:v}=e;return"horizontal"===l&&v<0?(d+=v,v=Math.abs(v)):"vertical"===l&&m<0&&(c+=m,m=Math.abs(m)),n.createElement("rect",{x:c,y:d,width:m,height:v,opacity:t||a&&a!==o?x(t,Object.assign(Object.assign({},r),{value:s}))?i:.3:i})})(e,ne,ce,N),onClick:ve})}))):n.createElement(k,{noDataText:R})))}));E.displayName="BarChart";export{E as default};
