'use client';
import{__rest as e}from"tslib";import r,{useRef as t,useMemo as a,isValidElement as l}from"react";import o from"../../../hooks/useInternalState.js";import{Combobox as n,Transition as s}from"@headlessui/react";import d from"../../../assets/ArrowDownHeadIcon.js";import m from"../../../assets/XCircleIcon.js";import{tremorTwMerge as c}from"../../../lib/tremorTwMerge.js";import{makeClassName as u}from"../../../lib/utils.js";import{constructValueToNameMapping as i,getFilteredOptions as p,getSelectButtonColors as f,hasValue as b}from"../selectUtils.js";const h=u("SearchSelect"),k=u("SearchSelect"),g=r.forwardRef(((u,g)=>{const{defaultValue:v="",searchValue:x,onSearchValueChange:w,value:y,onValueChange:N,placeholder:E="Select...",disabled:C=!1,icon:S,enableClear:V=!0,name:j,required:I,error:M=!1,errorMessage:T,children:D,className:F,id:q}=u,z=e(u,["defaultValue","searchValue","onSearchValueChange","value","onValueChange","placeholder","disabled","icon","enableClear","name","required","error","errorMessage","children","className","id"]),A=t(null),[O,B]=o("",x),[H,R]=o(v,y),U=S,{reactElementChildren:X,valueToNameMapping:G}=a((()=>{const e=r.Children.toArray(D).filter(l);return{reactElementChildren:e,valueToNameMapping:i(e)}}),[D]),J=a((()=>p(null!=O?O:"",X)),[O,X]);return r.createElement("div",{className:c("w-full min-w-[10rem] relative text-tremor-default")},r.createElement("select",{title:"search-select-hidden",required:I,className:c("h-full w-full absolute left-0 top-0 z-0 opacity-0"),value:H,onChange:e=>{e.preventDefault()},name:j,disabled:C,id:q,onFocus:()=>{const e=A.current;e&&e.click()}},r.createElement("option",{className:"hidden",value:"",disabled:!0,hidden:!0},E),J.map((e=>{const t=e.props.value,a=e.props.children;return r.createElement("option",{className:"hidden",key:t,value:t},a)}))),r.createElement(n,Object.assign({as:"div",ref:g,defaultValue:H,value:H,onChange:e=>{null==N||N(e),R(e)},disabled:C,className:c("w-full min-w-[10rem] relative text-tremor-default",F),id:q},z),(({value:e})=>r.createElement(r.Fragment,null,r.createElement(n.Button,{ref:A,className:"w-full"},U&&r.createElement("span",{className:c("absolute inset-y-0 left-0 flex items-center ml-px pl-2.5")},r.createElement(U,{className:c(h("Icon"),"flex-none h-5 w-5","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle")})),r.createElement(n.Input,{className:c("w-full outline-none text-left whitespace-nowrap truncate rounded-tremor-default focus:ring-2 transition duration-100 text-tremor-default pr-14 border py-2","border-tremor-border shadow-tremor-input focus:border-tremor-brand-subtle focus:ring-tremor-brand-muted","dark:border-dark-tremor-border dark:shadow-dark-tremor-input dark:focus:border-dark-tremor-brand-subtle dark:focus:ring-dark-tremor-brand-muted",U?"pl-10":"pl-3",C?"placeholder:text-tremor-content-subtle dark:placeholder:text-tremor-content-subtle":"placeholder:text-tremor-content dark:placeholder:text-tremor-content",f(b(e),C)),placeholder:E,onChange:e=>{null==w||w(e.target.value),B(e.target.value)},displayValue:e=>{var r;return null!==(r=G.get(e))&&void 0!==r?r:""}}),r.createElement("div",{className:c("absolute inset-y-0 right-0 flex items-center pr-2.5")},r.createElement(d,{className:c(h("arrowDownIcon"),"flex-none h-5 w-5","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle")}))),V&&H?r.createElement("button",{type:"button",className:c("absolute inset-y-0 right-0 flex items-center mr-8"),onClick:e=>{e.preventDefault(),R(""),B(""),null==N||N(""),null==w||w("")}},r.createElement(m,{className:c(k("clearIcon"),"flex-none h-4 w-4","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle")})):null,J.length>0&&r.createElement(s,{className:"absolute z-10 w-full",enter:"transition ease duration-100 transform",enterFrom:"opacity-0 -translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"transition ease duration-100 transform",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 -translate-y-4"},r.createElement(n.Options,{className:c("divide-y overflow-y-auto outline-none rounded-tremor-default text-tremor-default max-h-[228px] left-0 border my-1","bg-tremor-background border-tremor-border divide-tremor-border shadow-tremor-dropdown","dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border dark:shadow-dark-tremor-dropdown")},J))))),M&&T?r.createElement("p",{className:c("errorMessage","text-sm text-rose-500 mt-1")},T):null)}));g.displayName="SearchSelect";export{g as default};
